Index: data_insurance_analysis.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\r\n \"cells\": [\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 6,\r\n   \"id\": \"1949f5d7-1f2c-446d-b8d0-6688efaa6858\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"import pandas as pd\\n\",\r\n    \"import numpy as np\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 7,\r\n   \"id\": \"73403a7e-5895-4fda-b060-a6c06dbcee98\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"file_path = (r\\\"C:\\\\Users\\\\arailym\\\\PyProjects\\\\db_analysis\\\\data\\\\insurance.csv\\\")\\n\",\r\n    \"insurance_df = pd.read_csv(file_path)\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 8,\r\n   \"id\": \"fab01fce-5403-40f4-9750-9634213ada0c\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"data\": {\r\n      \"text/html\": [\r\n       \"<div>\\n\",\r\n       \"<style scoped>\\n\",\r\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\r\n       \"        vertical-align: middle;\\n\",\r\n       \"    }\\n\",\r\n       \"\\n\",\r\n       \"    .dataframe tbody tr th {\\n\",\r\n       \"        vertical-align: top;\\n\",\r\n       \"    }\\n\",\r\n       \"\\n\",\r\n       \"    .dataframe thead th {\\n\",\r\n       \"        text-align: right;\\n\",\r\n       \"    }\\n\",\r\n       \"</style>\\n\",\r\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\r\n       \"  <thead>\\n\",\r\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\r\n       \"      <th></th>\\n\",\r\n       \"      <th>age</th>\\n\",\r\n       \"      <th>sex</th>\\n\",\r\n       \"      <th>bmi</th>\\n\",\r\n       \"      <th>children</th>\\n\",\r\n       \"      <th>smoker</th>\\n\",\r\n       \"      <th>region</th>\\n\",\r\n       \"      <th>charges</th>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"  </thead>\\n\",\r\n       \"  <tbody>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>0</th>\\n\",\r\n       \"      <td>19</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>27.900</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southwest</td>\\n\",\r\n       \"      <td>16884.92400</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1</th>\\n\",\r\n       \"      <td>18</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>33.770</td>\\n\",\r\n       \"      <td>1</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>1725.55230</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>2</th>\\n\",\r\n       \"      <td>28</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>33.000</td>\\n\",\r\n       \"      <td>3</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>4449.46200</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>3</th>\\n\",\r\n       \"      <td>33</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>22.705</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>northwest</td>\\n\",\r\n       \"      <td>21984.47061</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>4</th>\\n\",\r\n       \"      <td>32</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>28.880</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>northwest</td>\\n\",\r\n       \"      <td>3866.85520</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"  </tbody>\\n\",\r\n       \"</table>\\n\",\r\n       \"</div>\"\r\n      ],\r\n      \"text/plain\": [\r\n       \"   age     sex     bmi  children smoker     region      charges\\n\",\r\n       \"0   19  female  27.900         0    yes  southwest  16884.92400\\n\",\r\n       \"1   18    male  33.770         1     no  southeast   1725.55230\\n\",\r\n       \"2   28    male  33.000         3     no  southeast   4449.46200\\n\",\r\n       \"3   33    male  22.705         0     no  northwest  21984.47061\\n\",\r\n       \"4   32    male  28.880         0     no  northwest   3866.85520\"\r\n      ]\r\n     },\r\n     \"execution_count\": 8,\r\n     \"metadata\": {},\r\n     \"output_type\": \"execute_result\"\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"insurance_df.head()\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 9,\r\n   \"id\": \"8b79794b-8e9d-46dc-9270-c7a5bbd6d193\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"name\": \"stdout\",\r\n     \"output_type\": \"stream\",\r\n     \"text\": [\r\n      \"<class 'pandas.core.frame.DataFrame'>\\n\",\r\n      \"RangeIndex: 1338 entries, 0 to 1337\\n\",\r\n      \"Data columns (total 7 columns):\\n\",\r\n      \" #   Column    Non-Null Count  Dtype  \\n\",\r\n      \"---  ------    --------------  -----  \\n\",\r\n      \" 0   age       1338 non-null   int64  \\n\",\r\n      \" 1   sex       1338 non-null   object \\n\",\r\n      \" 2   bmi       1338 non-null   float64\\n\",\r\n      \" 3   children  1338 non-null   int64  \\n\",\r\n      \" 4   smoker    1338 non-null   object \\n\",\r\n      \" 5   region    1338 non-null   object \\n\",\r\n      \" 6   charges   1338 non-null   float64\\n\",\r\n      \"dtypes: float64(2), int64(2), object(3)\\n\",\r\n      \"memory usage: 73.3+ KB\\n\"\r\n     ]\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"insurance_df.info()\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 10,\r\n   \"id\": \"19583062-c896-44d0-8cfe-3624cb976caa\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"# change data type\\n\",\r\n    \"insurance_df['sex'] = insurance_df['sex'].astype('string')\\n\",\r\n    \"insurance_df['smoker'] = insurance_df['smoker'].astype('string') \\n\",\r\n    \"insurance_df['region'] = insurance_df['region'].astype('string') \\n\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 11,\r\n   \"id\": \"24c4e2af-f167-4a07-8aba-7d0a76b2819d\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"def bmi_category(bmi):\\n\",\r\n    \"    if bmi < 18.5:\\n\",\r\n    \"        return \\\"Underweight\\\"\\n\",\r\n    \"    elif 18.5 <= bmi <= 24.9:\\n\",\r\n    \"        return \\\"Normal weight\\\"\\n\",\r\n    \"    elif 25 <= bmi < 29.9:\\n\",\r\n    \"        return \\\"overweight\\\"\\n\",\r\n    \"    else:\\n\",\r\n    \"        return \\\"obesity\\\"\\n\",\r\n    \"\\n\",\r\n    \"def age_group(age):\\n\",\r\n    \"    if age < 30:\\n\",\r\n    \"        return \\\"young\\\"\\n\",\r\n    \"    elif 30 <= age < 50:\\n\",\r\n    \"        return \\\"middle_age\\\"\\n\",\r\n    \"    else:\\n\",\r\n    \"        \\\"senior\\\"\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 12,\r\n   \"id\": \"a417b9b5-27d2-48f5-a8e4-f5d93add88f0\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"# user defined functions\\n\",\r\n    \"insurance_df['bmi_category'] = insurance_df['bmi'].apply(bmi_category) \\n\",\r\n    \"insurance_df['age_group'] = insurance_df['age'].apply(age_group)\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 13,\r\n   \"id\": \"195384a3-9b14-41d5-9c08-0ce5a0e74df7\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"data\": {\r\n      \"text/html\": [\r\n       \"<div>\\n\",\r\n       \"<style scoped>\\n\",\r\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\r\n       \"        vertical-align: middle;\\n\",\r\n       \"    }\\n\",\r\n       \"\\n\",\r\n       \"    .dataframe tbody tr th {\\n\",\r\n       \"        vertical-align: top;\\n\",\r\n       \"    }\\n\",\r\n       \"\\n\",\r\n       \"    .dataframe thead th {\\n\",\r\n       \"        text-align: right;\\n\",\r\n       \"    }\\n\",\r\n       \"</style>\\n\",\r\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\r\n       \"  <thead>\\n\",\r\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\r\n       \"      <th></th>\\n\",\r\n       \"      <th>age</th>\\n\",\r\n       \"      <th>sex</th>\\n\",\r\n       \"      <th>bmi</th>\\n\",\r\n       \"      <th>children</th>\\n\",\r\n       \"      <th>smoker</th>\\n\",\r\n       \"      <th>region</th>\\n\",\r\n       \"      <th>charges</th>\\n\",\r\n       \"      <th>bmi_category</th>\\n\",\r\n       \"      <th>age_group</th>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"  </thead>\\n\",\r\n       \"  <tbody>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>0</th>\\n\",\r\n       \"      <td>19</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>27.900</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southwest</td>\\n\",\r\n       \"      <td>16884.92400</td>\\n\",\r\n       \"      <td>overweight</td>\\n\",\r\n       \"      <td>young</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1</th>\\n\",\r\n       \"      <td>18</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>33.770</td>\\n\",\r\n       \"      <td>1</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>1725.55230</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>young</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>2</th>\\n\",\r\n       \"      <td>28</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>33.000</td>\\n\",\r\n       \"      <td>3</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>4449.46200</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>young</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>3</th>\\n\",\r\n       \"      <td>33</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>22.705</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>northwest</td>\\n\",\r\n       \"      <td>21984.47061</td>\\n\",\r\n       \"      <td>Normal weight</td>\\n\",\r\n       \"      <td>middle_age</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>4</th>\\n\",\r\n       \"      <td>32</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>28.880</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>no</td>\\n\",\r\n       \"      <td>northwest</td>\\n\",\r\n       \"      <td>3866.85520</td>\\n\",\r\n       \"      <td>overweight</td>\\n\",\r\n       \"      <td>middle_age</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"  </tbody>\\n\",\r\n       \"</table>\\n\",\r\n       \"</div>\"\r\n      ],\r\n      \"text/plain\": [\r\n       \"   age     sex     bmi  children smoker     region      charges  \\\\\\n\",\r\n       \"0   19  female  27.900         0    yes  southwest  16884.92400   \\n\",\r\n       \"1   18    male  33.770         1     no  southeast   1725.55230   \\n\",\r\n       \"2   28    male  33.000         3     no  southeast   4449.46200   \\n\",\r\n       \"3   33    male  22.705         0     no  northwest  21984.47061   \\n\",\r\n       \"4   32    male  28.880         0     no  northwest   3866.85520   \\n\",\r\n       \"\\n\",\r\n       \"    bmi_category   age_group  \\n\",\r\n       \"0     overweight       young  \\n\",\r\n       \"1        obesity       young  \\n\",\r\n       \"2        obesity       young  \\n\",\r\n       \"3  Normal weight  middle_age  \\n\",\r\n       \"4     overweight  middle_age  \"\r\n      ]\r\n     },\r\n     \"execution_count\": 13,\r\n     \"metadata\": {},\r\n     \"output_type\": \"execute_result\"\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"insurance_df.head()\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"markdown\",\r\n   \"id\": \"ae89ab16-03af-4976-9023-217918b98ae7\",\r\n   \"metadata\": {},\r\n   \"source\": [\r\n    \"Dropping columns\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 14,\r\n   \"id\": \"75cf0a8b-30a6-4ade-9c33-5705ea79d99c\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"# insurance_df = insurance_df.drop(columns='bmi_category',axis=1)\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 15,\r\n   \"id\": \"47ff8b58-af21-4f34-ae36-7a260834709f\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"# outliers\\n\",\r\n    \"outliers_df = insurance_df[insurance_df['charges'] > insurance_df['charges'].quantile(0.99)]\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 16,\r\n   \"id\": \"37728ca2-512b-4b4a-a574-c5ce6e42ba73\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"data\": {\r\n      \"text/html\": [\r\n       \"<div>\\n\",\r\n       \"<style scoped>\\n\",\r\n       \"    .dataframe tbody tr th:only-of-type {\\n\",\r\n       \"        vertical-align: middle;\\n\",\r\n       \"    }\\n\",\r\n       \"\\n\",\r\n       \"    .dataframe tbody tr th {\\n\",\r\n       \"        vertical-align: top;\\n\",\r\n       \"    }\\n\",\r\n       \"\\n\",\r\n       \"    .dataframe thead th {\\n\",\r\n       \"        text-align: right;\\n\",\r\n       \"    }\\n\",\r\n       \"</style>\\n\",\r\n       \"<table border=\\\"1\\\" class=\\\"dataframe\\\">\\n\",\r\n       \"  <thead>\\n\",\r\n       \"    <tr style=\\\"text-align: right;\\\">\\n\",\r\n       \"      <th></th>\\n\",\r\n       \"      <th>age</th>\\n\",\r\n       \"      <th>sex</th>\\n\",\r\n       \"      <th>bmi</th>\\n\",\r\n       \"      <th>children</th>\\n\",\r\n       \"      <th>smoker</th>\\n\",\r\n       \"      <th>region</th>\\n\",\r\n       \"      <th>charges</th>\\n\",\r\n       \"      <th>bmi_category</th>\\n\",\r\n       \"      <th>age_group</th>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"  </thead>\\n\",\r\n       \"  <tbody>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>34</th>\\n\",\r\n       \"      <td>28</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>36.400</td>\\n\",\r\n       \"      <td>1</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southwest</td>\\n\",\r\n       \"      <td>51194.55914</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>young</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>175</th>\\n\",\r\n       \"      <td>63</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>37.700</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southwest</td>\\n\",\r\n       \"      <td>48824.45000</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>281</th>\\n\",\r\n       \"      <td>54</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>40.565</td>\\n\",\r\n       \"      <td>3</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>northeast</td>\\n\",\r\n       \"      <td>48549.17835</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>488</th>\\n\",\r\n       \"      <td>44</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>38.060</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>48885.13561</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>middle_age</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>530</th>\\n\",\r\n       \"      <td>57</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>42.130</td>\\n\",\r\n       \"      <td>1</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>48675.51770</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>543</th>\\n\",\r\n       \"      <td>54</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>47.410</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>63770.42801</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>577</th>\\n\",\r\n       \"      <td>31</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>38.095</td>\\n\",\r\n       \"      <td>1</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>northeast</td>\\n\",\r\n       \"      <td>58571.07448</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>middle_age</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>819</th>\\n\",\r\n       \"      <td>33</td>\\n\",\r\n       \"      <td>female</td>\\n\",\r\n       \"      <td>35.530</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>northwest</td>\\n\",\r\n       \"      <td>55135.40209</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>middle_age</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>901</th>\\n\",\r\n       \"      <td>60</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>40.920</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>48673.55880</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1062</th>\\n\",\r\n       \"      <td>59</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>41.140</td>\\n\",\r\n       \"      <td>1</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>48970.24760</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1146</th>\\n\",\r\n       \"      <td>60</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>32.800</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southwest</td>\\n\",\r\n       \"      <td>52590.82939</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1230</th>\\n\",\r\n       \"      <td>52</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>34.485</td>\\n\",\r\n       \"      <td>3</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>northwest</td>\\n\",\r\n       \"      <td>60021.39897</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1241</th>\\n\",\r\n       \"      <td>64</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>36.960</td>\\n\",\r\n       \"      <td>2</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>49577.66240</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>None</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"    <tr>\\n\",\r\n       \"      <th>1300</th>\\n\",\r\n       \"      <td>45</td>\\n\",\r\n       \"      <td>male</td>\\n\",\r\n       \"      <td>30.360</td>\\n\",\r\n       \"      <td>0</td>\\n\",\r\n       \"      <td>yes</td>\\n\",\r\n       \"      <td>southeast</td>\\n\",\r\n       \"      <td>62592.87309</td>\\n\",\r\n       \"      <td>obesity</td>\\n\",\r\n       \"      <td>middle_age</td>\\n\",\r\n       \"    </tr>\\n\",\r\n       \"  </tbody>\\n\",\r\n       \"</table>\\n\",\r\n       \"</div>\"\r\n      ],\r\n      \"text/plain\": [\r\n       \"      age     sex     bmi  children smoker     region      charges  \\\\\\n\",\r\n       \"34     28    male  36.400         1    yes  southwest  51194.55914   \\n\",\r\n       \"175    63  female  37.700         0    yes  southwest  48824.45000   \\n\",\r\n       \"281    54    male  40.565         3    yes  northeast  48549.17835   \\n\",\r\n       \"488    44  female  38.060         0    yes  southeast  48885.13561   \\n\",\r\n       \"530    57    male  42.130         1    yes  southeast  48675.51770   \\n\",\r\n       \"543    54  female  47.410         0    yes  southeast  63770.42801   \\n\",\r\n       \"577    31  female  38.095         1    yes  northeast  58571.07448   \\n\",\r\n       \"819    33  female  35.530         0    yes  northwest  55135.40209   \\n\",\r\n       \"901    60    male  40.920         0    yes  southeast  48673.55880   \\n\",\r\n       \"1062   59    male  41.140         1    yes  southeast  48970.24760   \\n\",\r\n       \"1146   60    male  32.800         0    yes  southwest  52590.82939   \\n\",\r\n       \"1230   52    male  34.485         3    yes  northwest  60021.39897   \\n\",\r\n       \"1241   64    male  36.960         2    yes  southeast  49577.66240   \\n\",\r\n       \"1300   45    male  30.360         0    yes  southeast  62592.87309   \\n\",\r\n       \"\\n\",\r\n       \"     bmi_category   age_group  \\n\",\r\n       \"34        obesity       young  \\n\",\r\n       \"175       obesity        None  \\n\",\r\n       \"281       obesity        None  \\n\",\r\n       \"488       obesity  middle_age  \\n\",\r\n       \"530       obesity        None  \\n\",\r\n       \"543       obesity        None  \\n\",\r\n       \"577       obesity  middle_age  \\n\",\r\n       \"819       obesity  middle_age  \\n\",\r\n       \"901       obesity        None  \\n\",\r\n       \"1062      obesity        None  \\n\",\r\n       \"1146      obesity        None  \\n\",\r\n       \"1230      obesity        None  \\n\",\r\n       \"1241      obesity        None  \\n\",\r\n       \"1300      obesity  middle_age  \"\r\n      ]\r\n     },\r\n     \"execution_count\": 16,\r\n     \"metadata\": {},\r\n     \"output_type\": \"execute_result\"\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"outliers_df\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 17,\r\n   \"id\": \"da80f868-2c3c-4c49-98f7-b9fa2aeeae6e\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"data\": {\r\n      \"text/plain\": [\r\n       \"14\"\r\n      ]\r\n     },\r\n     \"execution_count\": 17,\r\n     \"metadata\": {},\r\n     \"output_type\": \"execute_result\"\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"# find how many outliers value\\n\",\r\n    \"len(outliers_df)\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 18,\r\n   \"id\": \"821bd59c-5284-45b9-9af0-0bb357653c77\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"insurance_df = insurance_df[insurance_df['charges'] <= insurance_df['charges'].quantile(0.99)] \"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 19,\r\n   \"id\": \"1ca606a6-94cb-4486-a5e0-a5824e7433b4\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"data\": {\r\n      \"text/plain\": [\r\n       \"(1324, 9)\"\r\n      ]\r\n     },\r\n     \"execution_count\": 19,\r\n     \"metadata\": {},\r\n     \"output_type\": \"execute_result\"\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"# checking number columns and row\\n\",\r\n    \"insurance_df.shape\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 20,\r\n   \"id\": \"9f4bfec8-bf29-4263-bc1a-b29a1dfddae4\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"name\": \"stdout\",\r\n     \"output_type\": \"stream\",\r\n     \"text\": [\r\n      \"<class 'pandas.core.frame.DataFrame'>\\n\",\r\n      \"Index: 1324 entries, 0 to 1337\\n\",\r\n      \"Data columns (total 9 columns):\\n\",\r\n      \" #   Column        Non-Null Count  Dtype  \\n\",\r\n      \"---  ------        --------------  -----  \\n\",\r\n      \" 0   age           1324 non-null   int64  \\n\",\r\n      \" 1   sex           1324 non-null   string \\n\",\r\n      \" 2   bmi           1324 non-null   float64\\n\",\r\n      \" 3   children      1324 non-null   int64  \\n\",\r\n      \" 4   smoker        1324 non-null   string \\n\",\r\n      \" 5   region        1324 non-null   string \\n\",\r\n      \" 6   charges       1324 non-null   float64\\n\",\r\n      \" 7   bmi_category  1324 non-null   object \\n\",\r\n      \" 8   age_group     948 non-null    object \\n\",\r\n      \"dtypes: float64(2), int64(2), object(2), string(3)\\n\",\r\n      \"memory usage: 103.4+ KB\\n\"\r\n     ]\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"insurance_df.info()\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 21,\r\n   \"id\": \"908e7b36-92f7-4b25-82ba-0a3900e59dab\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"data\": {\r\n      \"text/plain\": [\r\n       \"<StringArray>\\n\",\r\n       \"['southwest', 'southeast', 'northwest', 'northeast']\\n\",\r\n       \"Length: 4, dtype: string\"\r\n      ]\r\n     },\r\n     \"execution_count\": 21,\r\n     \"metadata\": {},\r\n     \"output_type\": \"execute_result\"\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"# displaying uniqe values\\n\",\r\n    \"insurance_df['region'].unique()\\n\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 22,\r\n   \"id\": \"ac70ddd1-129e-4942-9789-27c27b5b1000\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": [\r\n    \"# save file\\n\",\r\n    \"insurance_df.to_csv(r'C:\\\\Users\\\\arailym\\\\Python Basics\\\\python_da\\\\Data Files/cleaned_insurance.csv')\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": 23,\r\n   \"id\": \"a20ade03-20d0-4cae-8743-286a6c4ca05a\",\r\n   \"metadata\": {},\r\n   \"outputs\": [\r\n    {\r\n     \"name\": \"stdout\",\r\n     \"output_type\": \"stream\",\r\n     \"text\": [\r\n      \"Data saved to MySQL successfully\\n\"\r\n     ]\r\n    }\r\n   ],\r\n   \"source\": [\r\n    \"import mysql.connector\\n\",\r\n    \"from sqlalchemy import create_engine\\n\",\r\n    \"from urllib.parse import quote_plus\\n\",\r\n    \"\\n\",\r\n    \"# URL encode the password\\n\",\r\n    \"password_encoded = quote_plus('Aruzhan10@')\\n\",\r\n    \"\\n\",\r\n    \"db_config = {\\n\",\r\n    \"    'user': 'root',\\n\",\r\n    \"    'password': password_encoded,\\n\",\r\n    \"    'host': 'localhost',\\n\",\r\n    \"    'database': 'insurance_db',\\n\",\r\n    \"    'port': '3306'\\n\",\r\n    \"}\\n\",\r\n    \"\\n\",\r\n    \"# Build the connection string with the encoded password\\n\",\r\n    \"engine = create_engine(f\\\"mysql+mysqlconnector://{db_config['user']}:{db_config['password']}@{db_config['host']}:{db_config['port']}/{db_config['database']}\\\")\\n\",\r\n    \"\\n\",\r\n    \"# Send the DataFrame to MySQL\\n\",\r\n    \"insurance_df.to_sql(name=\\\"insurance_customers\\\", con=engine, if_exists='replace', index=False)\\n\",\r\n    \"\\n\",\r\n    \"print(\\\"Data saved to MySQL successfully\\\")\"\r\n   ]\r\n  },\r\n  {\r\n   \"cell_type\": \"code\",\r\n   \"execution_count\": null,\r\n   \"id\": \"f55ba339-d3f1-4da2-a8f6-1839357c067e\",\r\n   \"metadata\": {},\r\n   \"outputs\": [],\r\n   \"source\": []\r\n  }\r\n ],\r\n \"metadata\": {\r\n  \"kernelspec\": {\r\n   \"display_name\": \"Python 3 (ipykernel)\",\r\n   \"language\": \"python\",\r\n   \"name\": \"python3\"\r\n  },\r\n  \"language_info\": {\r\n   \"codemirror_mode\": {\r\n    \"name\": \"ipython\",\r\n    \"version\": 3\r\n   },\r\n   \"file_extension\": \".py\",\r\n   \"mimetype\": \"text/x-python\",\r\n   \"name\": \"python\",\r\n   \"nbconvert_exporter\": \"python\",\r\n   \"pygments_lexer\": \"ipython3\",\r\n   \"version\": \"3.12.5\"\r\n  }\r\n },\r\n \"nbformat\": 4,\r\n \"nbformat_minor\": 5\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/data_insurance_analysis.ipynb b/data_insurance_analysis.ipynb
--- a/data_insurance_analysis.ipynb	(revision 6caab88dacf21287f014bf5af3cca17d505b01bf)
+++ b/data_insurance_analysis.ipynb	(date 1727212816288)
@@ -2,7 +2,7 @@
  "cells": [
   {
    "cell_type": "code",
-   "execution_count": 6,
+   "execution_count": 2,
    "id": "1949f5d7-1f2c-446d-b8d0-6688efaa6858",
    "metadata": {},
    "outputs": [],
@@ -13,18 +13,18 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 7,
+   "execution_count": 4,
    "id": "73403a7e-5895-4fda-b060-a6c06dbcee98",
    "metadata": {},
    "outputs": [],
    "source": [
-    "file_path = (r\"C:\\Users\\arailym\\PyProjects\\db_analysis\\data\\insurance.csv\")\n",
+    "file_path = (r\"C:\\Users\\arailym\\PycharmProjects\\database analysis\\insurance.csv\")\n",
     "insurance_df = pd.read_csv(file_path)"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 8,
+   "execution_count": 5,
    "id": "fab01fce-5403-40f4-9750-9634213ada0c",
    "metadata": {},
    "outputs": [
@@ -122,7 +122,7 @@
        "4   32    male  28.880         0     no  northwest   3866.85520"
       ]
      },
-     "execution_count": 8,
+     "execution_count": 5,
      "metadata": {},
      "output_type": "execute_result"
     }
@@ -133,7 +133,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 9,
+   "execution_count": 6,
    "id": "8b79794b-8e9d-46dc-9270-c7a5bbd6d193",
    "metadata": {},
    "outputs": [
@@ -164,7 +164,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 10,
+   "execution_count": 7,
    "id": "19583062-c896-44d0-8cfe-3624cb976caa",
    "metadata": {},
    "outputs": [],
@@ -177,7 +177,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 11,
+   "execution_count": 8,
    "id": "24c4e2af-f167-4a07-8aba-7d0a76b2819d",
    "metadata": {},
    "outputs": [],
@@ -203,7 +203,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 12,
+   "execution_count": 9,
    "id": "a417b9b5-27d2-48f5-a8e4-f5d93add88f0",
    "metadata": {},
    "outputs": [],
@@ -215,7 +215,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 13,
+   "execution_count": 10,
    "id": "195384a3-9b14-41d5-9c08-0ce5a0e74df7",
    "metadata": {},
    "outputs": [
@@ -332,7 +332,7 @@
        "4     overweight  middle_age  "
       ]
      },
-     "execution_count": 13,
+     "execution_count": 10,
      "metadata": {},
      "output_type": "execute_result"
     }
@@ -351,7 +351,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 14,
+   "execution_count": 11,
    "id": "75cf0a8b-30a6-4ade-9c33-5705ea79d99c",
    "metadata": {},
    "outputs": [],
@@ -361,7 +361,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 15,
+   "execution_count": 12,
    "id": "47ff8b58-af21-4f34-ae36-7a260834709f",
    "metadata": {},
    "outputs": [],
@@ -372,7 +372,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 16,
+   "execution_count": 13,
    "id": "37728ca2-512b-4b4a-a574-c5ce6e42ba73",
    "metadata": {},
    "outputs": [
@@ -615,7 +615,7 @@
        "1300      obesity  middle_age  "
       ]
      },
-     "execution_count": 16,
+     "execution_count": 13,
      "metadata": {},
      "output_type": "execute_result"
     }
@@ -626,7 +626,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 17,
+   "execution_count": 14,
    "id": "da80f868-2c3c-4c49-98f7-b9fa2aeeae6e",
    "metadata": {},
    "outputs": [
@@ -636,7 +636,7 @@
        "14"
       ]
      },
-     "execution_count": 17,
+     "execution_count": 14,
      "metadata": {},
      "output_type": "execute_result"
     }
@@ -648,7 +648,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 18,
+   "execution_count": 15,
    "id": "821bd59c-5284-45b9-9af0-0bb357653c77",
    "metadata": {},
    "outputs": [],
@@ -658,7 +658,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 19,
+   "execution_count": 16,
    "id": "1ca606a6-94cb-4486-a5e0-a5824e7433b4",
    "metadata": {},
    "outputs": [
@@ -668,7 +668,7 @@
        "(1324, 9)"
       ]
      },
-     "execution_count": 19,
+     "execution_count": 16,
      "metadata": {},
      "output_type": "execute_result"
     }
@@ -680,7 +680,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 20,
+   "execution_count": 17,
    "id": "9f4bfec8-bf29-4263-bc1a-b29a1dfddae4",
    "metadata": {},
    "outputs": [
@@ -713,7 +713,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 21,
+   "execution_count": 18,
    "id": "908e7b36-92f7-4b25-82ba-0a3900e59dab",
    "metadata": {},
    "outputs": [
@@ -725,7 +725,7 @@
        "Length: 4, dtype: string"
       ]
      },
-     "execution_count": 21,
+     "execution_count": 18,
      "metadata": {},
      "output_type": "execute_result"
     }
@@ -737,18 +737,18 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 22,
+   "execution_count": 20,
    "id": "ac70ddd1-129e-4942-9789-27c27b5b1000",
    "metadata": {},
    "outputs": [],
    "source": [
     "# save file\n",
-    "insurance_df.to_csv(r'C:\\Users\\arailym\\Python Basics\\python_da\\Data Files/cleaned_insurance.csv')"
+    "insurance_df.to_csv(r'C:\\Users\\arailym\\PycharmProjects\\database analysis\\insurance.csv')"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 23,
+   "execution_count": 21,
    "id": "a20ade03-20d0-4cae-8743-286a6c4ca05a",
    "metadata": {},
    "outputs": [
@@ -792,6 +792,30 @@
    "metadata": {},
    "outputs": [],
    "source": []
+  },
+  {
+   "cell_type": "code",
+   "execution_count": null,
+   "id": "0d2730f8-1dc2-4dd0-826f-6d21a7f5a438",
+   "metadata": {},
+   "outputs": [],
+   "source": []
+  },
+  {
+   "cell_type": "code",
+   "execution_count": null,
+   "id": "47995194-d15a-4ca5-9b72-105b15792a7c",
+   "metadata": {},
+   "outputs": [],
+   "source": []
+  },
+  {
+   "cell_type": "code",
+   "execution_count": null,
+   "id": "312b48fe-60ce-4b37-a3e2-d47d84ffd325",
+   "metadata": {},
+   "outputs": [],
+   "source": []
   }
  ],
  "metadata": {
